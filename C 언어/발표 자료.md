```c
cluster_t
fat_create_chain (cluster_t clst) {
	
	cluster_t i = 2;
	while (fat_get(i) != 0 && i < fat_fs->fat_length)
	{
		++i;
	}
	
   
	if (i == fat_fs->fat_length)
	{
		return 0;
	}
	
	fat_put(i, EOChain);

  
	if (clst == 0)
	{
		return i;
	}

	while(fat_get(clst) != EOChain)
	{
		clst = fat_get(clst);
	}

	fat_put(clst, i);
	return i;
}
```



함수 fat_create_chain()은 파일 할당 테이블 (FAT)에 새 체인을 생성합니다. 이 함수는 클러스터 번호 clst를 인수로 받습니다. clst가 0이면 함수는 FAT의 끝에 새 체인을 생성합니다.

이 함수는 먼저 FAT에서 첫 번째 사용 가능한 클러스터를 찾습니다. FAT에서 클러스터 2부터 시작하여 반복하여 수행합니다. 클러스터가 사용되지 않으면 함수는 i를 증가시키고 계속 반복합니다. FAT의 끝에 도달하여 사용 가능한 클러스터를 찾지 못하면 함수는 0을 반환합니다.

함수는 사용 가능한 클러스터를 찾은 후 해당 클러스터의 FAT 항목을 EOChain으로 설정합니다. 이는 클러스터가 체인의 끝임을 나타냅니다. clst가 0이 아니면 함수는 clst에서 시작하여 체인의 끝에 도달할 때까지 체인을 따라갑니다. 체인의 각 클러스터에 대해 함수는 체인의 다음 클러스터의 클러스터 번호로 FAT 항목을 설정합니다.

마지막으로 함수는 새 체인의 첫 번째 클러스터의 클러스터 번호를 반환합니다.

1. 함수는 i를 2(0bute, 1루트 디렉토리에 예약)로 초기화합니다. 이는 사용되지 않는 첫 번째 클러스터입니다.
2. 함수는 FAT에서 클러스터 2부터 시작하여 반복합니다.
3. 클러스터가 사용되지 않으면 함수는 i를 증가시키고 계속 반복합니다.
4. 함수가 FAT의 끝에 도달하여 사용 가능한 클러스터를 찾지 못하면 함수는 0을 반환합니다.
5. 함수는 사용 가능한 클러스터를 찾은 후 해당 클러스터의 FAT 항목을 EOChain으로 설정합니다. 이는 클러스터가 체인의 끝임을 나타냅니다.
6. clst가 0이 아니면 함수는 clst에서 시작하여 체인의 끝에 도달할 때까지 체인을 따라갑니다.
7. 체인의 각 클러스터에 대해 함수는 체인의 다음 클러스터의 클러스터 번호로 FAT 항목을 설정합니다.
8. 마지막으로 함수는 새 체인의 첫 번째 클러스터의 클러스터 번호를 반환합니다.

### 

#### 함수 호출 할 때

파일 할당 테이블 (FAT) 파일 시스템에 새 파일이 생성되면 fat_create_chain() 함수가 호출됩니다. 함수는 파일의 데이터를 저장하기 위해 새 클러스터 체인을 생성합니다. 체인의 첫 번째 클러스터는 함수에 의해 반환됩니다. 체인의 다음 클러스터는 첫 번째 클러스터의 FAT 항목에 의해 결정됩니다. 첫 번째 클러스터의 FAT 항목에는 체인의 다음 클러스터의 클러스터 번호가 포함되어 있습니다. 이 프로세스는 파일의 모든 데이터가 체인에 저장될 때까지 계속됩니다.

파일의 크기가 조정되면 fat_create_chain() 함수도 호출됩니다. 파일의 크기가 조정되면 fat_create_chain() 함수가 호출되어 추가 데이터를 저장하기 위해 새 클러스터를 생성합니다. fat_create_chain() 함수는 파일의 체인에 있는 기존 클러스터의 FAT 항목을 새 클러스터에 대한 포인터로 업데이트합니다.

fat_create_chain() 함수는 FAT 파일 시스템의 중요한 부분입니다. 파일의 데이터를 저장하는 클러스터 체인을 생성하고 관리하는 역할을 담당합니다.



```c
void
fat_remove_chain (cluster_t clst, cluster_t pclst) { //! pclst는 clst 앞에 꺼
	// TODO: Your code goes here. */
	cluster_t next;
	while(fat_fs->fat[clst] != EOChain)
	{
		next = fat_fs->fat[clst];
		fat_fs->fat[clst] = 0;
		clst = next;
	}
    
    fat_fs->fat[clst] = 0;
	
	if(pclst != 0)
		fat_fs->fat[pclst] = EOChain;
}
```



fat_remove_chain() 함수는 파일 할당 테이블 (FAT)에서 체인을 제거합니다. 이 함수는 두 개의 인수를 받습니다. clst는 제거할 체인의 첫 번째 클러스터 번호입니다. pclst는 체인의 clst 앞 클러스터 번호입니다.

이 함수는 먼저 clst 다음 체인의 다음 클러스터를 찾습니다. 이 작업은 clst에 대한 FAT 항목을 읽어서 수행됩니다. clst에 대한 FAT 항목에는 체인의 다음 클러스터 번호가 포함되어 있습니다.

체인의 다음 클러스터가 발견되면 함수는 clst에 대한 FAT 항목을 0으로 설정합니다. 이는 해당 클러스터가 더 이상 사용되지 않음을 나타냅니다.

그런 다음 함수는 프로세스를 반복하여 체인의 다음 클러스터를 찾고 이전 클러스터의 FAT 항목을 0으로 설정합니다. 이 프로세스는 체인의 끝에 도달할 때까지 계속됩니다.

마지막으로, pclst가 0이 아닌 경우 함수는 FAT 항목을 EOChain으로 설정합니다. 이는 체인이 제거되었음을 나타냅니다.

다음은 함수에 대한 보다 자세한 설명입니다.

함수는 next를 0으로 초기화합니다. 함수는 clst에 대한 FAT 항목을 읽습니다. 함수는 next를 FAT 항목의 값으로 설정합니다. 함수는 clst에 대한 FAT 항목을 0으로 설정합니다. 함수는 clst를 next로 설정합니다. 함수는 2-5단계를 clst가 0과 같을 때까지 반복합니다. pclst가 0이 아닌 경우 함수는 FAT 항목을 EOChain으로 설정합니다.

fat_remove_chain() 함수는 FAT 파일 시스템의 중요한 부분입니다. 더 이상 사용되지 않는 클러스터 체인을 제거하는 역할을 담당합니다.



함수 호출 할때

fat_remove_chain() 함수는 파일이 삭제될 때 호출됩니다. 이 함수는 파일이 사용하고 있던 클러스터 체인을 제거합니다. 이렇게 하면 클러스터가 다른 파일에 다시 사용될 수 있습니다.