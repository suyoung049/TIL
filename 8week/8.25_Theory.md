# Query Set API

- gt

```
Entry.objects.filter(id__gt=4)
```

```sqlite
SELECT...WHERE id > 4;
```

- gte

```python
Entry.objects.filter(id__gte=4)
```

```sqlite
SELECT...WHERE id >= 4;
```

- lt, lte

```python
Entry.objects.filter(id__lt=4)
Entry.objects.filter(id__lte=4)
```

```sqlite
SELECT...WHERE id < 4;
SELECT...WHERE id <= 4;
```

- in 

```python
Entry.object.filter(id__in=[1,3,4])
Entry.object.filter(headline__in='abc')
```

```sqlite
SELECT ... WHERE id IN (1, 3, 4);
SELECT ... WHERE headline IN ('a', 'b', 'c');
```

- startswith

```python
Entry.object.filter(headline__startswith='Lennon')
```

```sqlite
SELECT ... WHERE headline LIKE 'Lennon%';
```

- istartswith(ëŒ€, ì†Œë¬¸ì êµ¬ë³„ì—†ì´ ì‚¬ìš©)

```python
Entry.object.filter(headline__istartswith='Lennon')
```

```sqlite
SELECT ... WHERE headline ILIKE 'Lennon%';
```

- endswith

```python
Entry.object.filter(headline__endswith='Lennon')
Entry.object.filter(headline__iendswith='Lennon')
```

```sqlite
SELECT ... WHERE headline LIKE '%Lennon';
SELECT ... WHERE headline ILIKE '%Lennon';
```

- contains

```python
Entry.object.filter(headline__contains='Lennon')
Entry.object.filter(headline__icontains='Lennon')
```

```sqlite
SELECT ... WHERE headline LIKE '%Lennon%';
SELECT ... WHERE headline ILIKE '%Lennon%';
```

- range

```python
import datetime
start_date = datetime.date(2005,1,1)
end_date = datetime.date(2005, 3, 31)
Entry.object.filter(pub_date__range=(start_date, end_date))
```

```sql
SELECT ... WHERE pub_date
BETWEEN '2005-01-01' and '2005-03-31';
```

- ë³µí•© í™œìš©

```python
inner_qs = Blog.objects.filter(name__contains='Cheddar')
entries = Entry.opjects.filter(blog__in=inner_qs)
```

```sqlite
SELECT...
WHERE blog.id IN (SELECT id FROM ... WHERE NAME LIKE '%Cheddar%');
```

- í™œìš©

```python
Entry.objects.all()[0]
```

```sqlite
SELECT ...
LIMIT 1;
```

```python
Movie.objects.order_by('opening_date')
```

```sqlite
SELECT ...
ORDER BY opening_date;
```

```py
Movie.objects.order_by('-opening_date')
```

```sqlite
SELECT ...
ORDER BY opening_date DESC;
```



## ORM í™•ì¥(1:N)

- ëª¨ë¸ë§

```python
class Director(models.Model):
    name = models.TextField()
    debut = models.DateTimeField()
    country = models.TextField()

class Genre(models.Model):
    title = models.TextField()

class Movie(models.Model):
    director = models.ForeignKey(Director,on_delete=models.CASCADE)
    genre = models.ForeignKey(Genre,on_delete=models.CASCADE)
    title = models.TextField()
    opening_date = models.DateField()
    running_time = models.IntegerField()
    screening = models.BooleanField()
```

- Foreign Key(ì™¸ë˜í‚¤)
  - í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€ëª¨ í…Œì´ë¸”ì˜ ìœ ì¼í•œ ê°’ì„ ì°¸ì¡°(ì°¸ì¡° ë¬´ê²°ì„±)
    - ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„ ëª¨ë¸ì—ì„œ ê´€ë ¨ëœ 2ê°œì˜ í…Œì´ë¸” ê°„ì˜ ì¼ê´€ì„±
  - ì™¸ë˜ í‚¤ì˜ ê°’ì´ ë°˜ë“œì‹œ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ì¼ í•„ìš”ëŠ” ì—†ì§€ë§Œ ìœ ì¼í•œ ê°’ì´ì–´ì•¼í•¨
- models.ForeignKey í•„ë“œ
  - 2ê°œì˜ í•„ìˆ˜ ìœ„ì¹˜ ì¸ì
    - Model class : ì°¸ì¡°í•˜ëŠ” ëª¨ë¸
    - on_delete : ì™¸ë˜ í‚¤ê°€ ì°¸ì¡°í•˜ëŠ” ê°ì²´ê°€ ì‚­ì œë˜ì—ˆ ë•Œ ì²˜ë¦¬ ë°©ì‹
      - CASCADE : ë¶€ëª¨ ê°ì²´(ì°¸ì¡° ëœ ê°ì²´)ê°€ ì‚­ì œ ë˜ì—ˆì„ ë•Œ ì´ë¥¼ ì°¸ì¡°í•˜ëŠ” ê°ì²´ë„ ì‚­ì œ
      - PROTECT : ì‚­ì œë˜ì§€ ì•ŠìŒ
      - SET_NULL : NULL ì„¤ì •
      - SET_DEFAULT : ê¸°ë³¸ ê°’ ì„¤ì •

- Create

```python
director_ = Director.objects.get(name='ë´‰ì¤€í˜¸')
genre_ = Genre.objects.get(title='ë“œë¼ë§ˆ')

movie = Movie()
movie.director = director_
movie.genre = genre_
movie.title = 'ê¸°ìƒì¶©'
movie.opening_date = '2019-05-30'
movie.running_time = '132'
movie.screening = False
movie.save()
```

- ì°¸ì¡°ì™€ ì—­ì°¸ì¡°

```python
movie = Movie.objects.get(id=1)
movie.director
# <Director : Director object(1)>
mocie.gener
# <Gener : Genre object(1)>


# ì—­ì°¸ì¡°
genre = Genre.objects.get(id=1)
genre.album_set.all()
```

> ì°¸ê³  ì‚¬ì´íŠ¸

[[Django] QuerySet ë©”ì†Œë“œ ì •ë¦¬ (2) - CRUD](https://devvvyang.tistory.com/37)

## ğŸ’ª 8.25 [Training](./8.25_Practice/DB_08.md)
